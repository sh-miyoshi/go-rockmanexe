FROM golang:1.16 as builder

WORKDIR /app
COPY go.mod .
COPY go.sum .
COPY cmd/router cmd/router
COPY pkg pkg
RUN go build ./cmd/router

FROM ubuntu:20.04

EXPOSE 16283

WORKDIR /app
COPY --from=builder /app/router router
COPY cmd/router/config.yaml config.yaml
CMD ./router --config=config.yaml
